"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[34075],{482086:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FlashlightSpotlightDots_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetStringifiedCommerceAuxData_pin"}],type:"Pin",abstractKey:null};n.hash="3a8409077905af94eb39568e4a5a57fc";let a=n},314494:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StelaCutout_pin",selections:[{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};n.hash="0b66eea622c037ef845cce3aa4cd2d46";let a=n},752824:(e,t,i)=>{var n;i.r(t),i.d(t,{default:()=>r});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useGetNormalizedPinImage_pin",selections:[{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"236x")'}],type:"Pin",abstractKey:null};a.hash="3d7a6d04f923d00acfb2887f852aea16";let r=a},159352:(e,t,i)=>{i.d(t,{Z:()=>f});var n=i(667294),a=i(883119),r=i(219308),s=i(476943),l=i(785893);function o({top:e,left:t,bottom:i,right:n,size:r,transition:s}){return(0,l.jsx)(a.xu,{color:"default",dangerouslySetInlineStyle:{__style:{top:e,left:t,right:n,bottom:i,transition:s}},height:r,position:"absolute",rounding:"circle",width:r})}function u({anchorSize:e,corner:t,maxTouchSize:i}){let n=s.FA[t],r=`${s.tT} ${t}`,o=Math.min(s.oq*s.MS,i),u=(o-e)/2,c=t.includes("n")?-u:void 0,d=t.includes("w")?-u:void 0,h=t.includes("s")?-u:void 0,p=t.includes("e")?-u:void 0;return(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{top:c,left:d,bottom:h,right:p,cursor:n,pointerEvents:"auto"}},"data-test-id":`cropper-corner-${t}`,height:o,id:r,position:"absolute",width:o})}function c({w:e,h:t,minSize:i,maxSize:n}){let a=Math.min(e,t);if(a<=s.yz)return n-i;if(a<s.RD){let e=(n-i)/(s.RD-s.yz);return e*(s.RD-a)}return 0}let d=({x:e,y:t,size:i})=>`linear-gradient(black, black) ${e}px ${t}px / ${i}px ${i}px no-repeat`;function h({x:e,y:t,w:i,h:n,size:r,transition:h,visibility:p}){let m=r/2,x=s.oq/2-s.xh-s.ps-s.eq+c({w:i,h:n,minSize:s.eq,maxSize:0}),g=i+2*m-2*x,y=n+2*m-2*x,f=s.oq-r,S=Math.max(s.XN-f,s.YY),v=s.xh/2,w=r-v,b=w-v,_=(Math.min(g,y)-s.dH)/2,k=d({x:0,y:0,size:w}),M=d({x:g-w,y:0,size:w}),z=d({x:0,y:y-w,size:w}),j=d({x:g-w,y:y-w,size:w});return(0,l.jsxs)(a.xu,{dangerouslySetInlineStyle:{__style:{top:t-m+x,left:e-m+x,pointerEvents:"none",visibility:p,transition:h}},height:y,position:"absolute",width:g,children:[(0,l.jsx)(a.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${s.xh}px solid white`,borderRadius:`${S}px`,mask:`${k}, ${M}, ${z}, ${j}`,pointerEvents:"none",transition:h}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,l.jsx)(o,{left:0,size:s.xh,top:b,transition:h}),(0,l.jsx)(o,{left:b,size:s.xh,top:0,transition:h}),(0,l.jsx)(u,{anchorSize:r,corner:"nw",maxTouchSize:_}),(0,l.jsx)(o,{right:0,size:s.xh,top:b,transition:h}),(0,l.jsx)(o,{right:b,size:s.xh,top:0,transition:h}),(0,l.jsx)(u,{anchorSize:r,corner:"ne",maxTouchSize:_}),(0,l.jsx)(o,{bottom:0,left:b,size:s.xh,transition:h}),(0,l.jsx)(o,{bottom:b,left:0,size:s.xh,transition:h}),(0,l.jsx)(u,{anchorSize:r,corner:"sw",maxTouchSize:_}),(0,l.jsx)(o,{bottom:0,right:b,size:s.xh,transition:h}),(0,l.jsx)(o,{bottom:b,right:0,size:s.xh,transition:h}),(0,l.jsx)(u,{anchorSize:r,corner:"se",maxTouchSize:_})]})}var p=i(50904);let m=({coordinate:e,cropSize:t,maxBound:i,minBound:n})=>e<=n?n:i<=e+t?i-t:e;var x=i(316886),g=i(984804),y=i(288736);function f({children:e,cropArea:{x:t,y:i,w:o,h:u},hoveredCutoutIndex:d,imageContainerX:f,imageContainerY:S,imageSize:{width:v=1,height:w=1},objectDetection:b,onChange:_,setHoveredCutoutIndex:k,setSelectedCutoutIndex:M,viewParameter:z,viewType:j}){let P=(0,r.Z)(),$=(0,n.useRef)(null),I=(0,n.useMemo)(()=>({x:0,y:0,w:v,h:w}),[w,v]),F=(0,n.useMemo)(()=>(0,p.Z)({cropArea:{x:t,y:i,w:o,h:u},imageSize:{width:v,height:w}}),[u,o,t,i,w,v]),[E,L]=(0,n.useState)(()=>(0,x.ZP)({x:t,y:i,w:o,h:u},I)?I:F),[D,Z]=(0,n.useState)("none"),[T,A]=(0,n.useState)("none"),[C,K]=(0,n.useState)(!1),[R,W]=(0,n.useState)(!1),[q,H]=(0,n.useState)(!1),[N,O]=(0,n.useState)(0),[X,B]=(0,n.useState)(0),{x:G,y:U,w:Y,h:J}=E,V=(0,n.useMemo)(()=>(0,x.ZP)(E,I),[E,I]),Q=(0,n.useMemo)(()=>c({w:Y,h:J,minSize:s.Zn,maxSize:s.oq}),[J,Y]),ee=s.SP,et=s.SP,ei=v-s.SP,en=w-s.SP,ea="number"==typeof d,er=R?"none":"0.3s cubic-bezier(0.42, 0, 0.58, 1.2)",es=function({cropperSelection:e,anchorSelection:t,hasMouseMoved:i}){if("background"===e&&i)return"crosshair";if("cropbox"===e&&i)return"move";if("anchor"===e){if("nw"===t||"se"===t)return"nwse-resize";else if("ne"===t||"sw"===t)return"nesw-resize"}return"auto"}({cropperSelection:D,anchorSelection:T,hasMouseMoved:R}),el=e=>{e.preventDefault(),e.stopPropagation();let{clientX:t,clientY:i,target:n}=e,a=t-f,r=i-S;W(!1),H(!1),O(a),B(r);let{id:l}=n,[o,u="none"]=l.split(" "),c=`${o}`===s.tT,d=l===s.at,h=l===s.eX,p=l===g.P,m=l===y.I;c?(Z("anchor"),A(u)):h?Z("cropbox"):d?Z("background"):(!(G<a&&a<G+Y&&U<r&&r<U+J)||V?Z("background"):Z("cropbox"),K(p||m))},eo=e=>{if("none"===D)return;let{clientX:t,clientY:i}=e,n=t-f,a=i-S;if(!(Math.abs(n-N)<s.yG&&Math.abs(a-X)<s.yG&&!R&&["cropbox","background"].includes(D)))switch(W(!0),K(!1),M(null),k(null),D){case"anchor":{let e=["nw","sw"].includes(T),t=["nw","ne"].includes(T),i=Math.max(Math.min(n,ei),ee),r=Math.max(Math.min(a,en),et),l=e?Math.min(i,G+Y-s.yz):G,o=t?Math.min(r,U+J-s.yz):U;L({x:l,y:o,w:e?Math.max(G+Y-i,s.yz):Math.max(i-G,s.yz),h:t?Math.max(U+J-r,s.yz):Math.max(r-U,s.yz)});break}case"cropbox":{let e=Math.max(Math.min(G+(n-N),v-Y-ee),ee),t=Math.max(Math.min(U+(a-X),w-J-et),et);O(n),B(a),L({x:e,y:t,w:Y,h:J});break}case"background":{let e=Math.max(Math.min(n,v),0),t=Math.max(Math.min(a,w),0),i=e-N,r=t-X;L({x:Math.min(N,e),y:Math.min(X,t),w:Math.abs(i),h:Math.abs(r)})}}},eu=()=>{if(Z("none"),A("none"),K(!1),W(!1),"none"===D)return;if(C&&("cutouts"===b&&ea||"dots"===b)){H(!0);return}let e=(e,t)=>{_({cropArea:e,cropSource:t}),L(e)};if(R){let t=Math.max(Math.min(G,v-s.yz-ee),ee),i=Math.max(Math.min(U,w-s.yz-et),et),n=J<s.yz?s.yz:i+J>w-et?w-i-et:J,a=Y<s.yz?s.yz:t+Y>v-ee?v-t-ee:Y;e({x:t,y:i,w:a,h:n},6),"cropbox"===D?P({event_type:7603,view_type:j,view_parameter:z}):"anchor"===D?P({event_type:7604,view_type:j,view_parameter:z}):"background"===D&&P({event_type:16584,view_type:j,view_parameter:z})}else V||"background"===D?(e(function({cropSize:e,imageHeight:t,imageWidth:i,minBound:n,mouseX:a,mouseY:r}){let s=a-e/2,l=r-e/2,o=i-n,u=t-n;return{x:m({coordinate:s,minBound:n,maxBound:o,cropSize:e}),y:m({coordinate:l,minBound:n,maxBound:u,cropSize:e}),w:e,h:e}}({mouseX:N,mouseY:X,cropSize:s.Rk,minBound:s.SP,imageWidth:v,imageHeight:w}),6),P({event_type:16585,view_type:j,view_parameter:z})):"cropbox"===D&&(e(I,5),P({event_type:16586,view_type:j,view_parameter:z}))};return(0,n.useEffect)(()=>{q&&L(F)},[F,q]),(0,n.useEffect)(()=>{let e=$.current;return e?.addEventListener("mousedown",el),window.addEventListener("mousemove",eo),window.addEventListener("mouseup",eu),()=>{e?.removeEventListener("mousedown",el),window.removeEventListener("mousemove",eo),window.removeEventListener("mouseup",eu)}}),(0,l.jsxs)(a.xu,{ref:$,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:es}},"data-test-id":"visual-search-cropper",left:!0,position:"absolute",right:!0,top:!0,children:[(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{border:`${s.ps}px solid rgba(255, 255, 255, 0.20)`,borderRadius:`${s.CX-Q}px`,boxShadow:"0 0 0 99999px rgba(0, 0, 0, 0.35)",left:G,top:U,transition:er}},height:J,position:"absolute",width:Y}),(0,l.jsx)(a.xu,{bottom:!0,id:s.at,left:!0,position:"absolute",right:!0,top:!0}),(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{visibility:V?"hidden":"visible",left:G,top:U}},"data-test-id":"cropper-section",height:J,id:s.eX,position:"absolute",width:Y}),e,(0,l.jsx)(h,{h:J,size:s.oq-Q,transition:er,visibility:V||"background"===D&&R?"hidden":"visible",w:Y,x:G,y:U})]})}},476943:(e,t,i)=>{i.d(t,{CX:()=>w,FA:()=>y,MS:()=>u,OI:()=>s,RD:()=>b,Rk:()=>k,SP:()=>a,Wm:()=>n,XN:()=>p,YY:()=>m,Zn:()=>h,at:()=>f,dH:()=>g,eX:()=>S,eq:()=>x,iC:()=>l,oq:()=>d,ps:()=>v,tT:()=>o,xZ:()=>r,xh:()=>c,yG:()=>M,yz:()=>_});let n=446,a=16,r=48,s={x:0,y:0,w:0,h:0},l=`
  .preview-crop-area-enter {
    opacity: 0;
  }

  .preview-crop-area-enter-active {
    opacity: 1;
    transition: opacity 300ms;
  }

  .preview-crop-area-exit {
    opacity: 1;
  }

  .preview-crop-area-exit-active {
    opacity: 0;
    transition: opacity 300ms;
  }

  .preview-crop-area-exit-done {
    opacity: 0;
  }
`,o="anchor",u=2,c=4,d=20,h=14,p=16,m=10,x=3,g=8,y={nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},f="cropper-background",S="cropper-cropbox",v=1,w=10,b=32,_=20,k=120,M=2},50904:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(476943);function a({cropArea:e,imageSize:t}){let{x:i,y:a,w:r,h:s}=e,{height:l,width:o}=t;if(!l||!o)return e;let u=i,c=a,d=r,h=s;return u<n.SP&&(u=n.SP,d-=n.SP-i),u+d>o-n.SP&&(d-=u+d-o+n.SP),c<n.SP&&(c=n.SP,h-=n.SP-a),c+h>l-n.SP&&(h-=c+h-l+n.SP),{x:u,y:c,w:d,h:h}}},984804:(e,t,i)=>{i.d(t,{P:()=>l,Z:()=>c});var n=i(667294),a=i(883119),r=i(233846),s=i(785893);let l="flashlight-dot-style",o=16,u=32,c=(0,n.forwardRef)(({icon:e,onClick:t,onMouseDown:i,onMouseEnter:c,onMouseLeave:d,onMouseUp:h,selected:p,style:m,text:x,x:g,y,zIndex:f,backdropDiameter:S=u,dotDiameter:v=o},w)=>{let[b,_]=(0,n.useState)(!1),k=(0,r.ZP)(),M=b?S+4:S;return(0,s.jsx)(a.xu,{ref:w,dangerouslySetInlineStyle:{__style:{top:y-M/2,left:g-M/2,outline:"none"}},position:"absolute",zIndex:new a.Ry(f||0),children:(0,s.jsx)(a.iP,{accessibilityLabel:k.bt("Search for this item", "Search this item", "flashlight.dot.a11ylabel", undefined, true),dataTestId:"flashlight-dot",onMouseDown:i,onMouseEnter:({event:e})=>{_(!0),c?.({event:e})},onMouseLeave:({event:e})=>{_(!1),d?.({event:e})},onMouseUp:h,onTap:t,tabIndex:0,children:(0,s.jsxs)(a.xu,{alignItems:"center",borderStyle:"none",color:"default",dangerouslySetInlineStyle:{__style:{boxShadow:p?"0 0 0 3px #e60023":"none",borderRadius:v,top:(M-v)/2,left:(M-v)/2,...m}},"data-test-id":l,display:"flex",height:v,id:l,justifyContent:"center",padding:0,position:"absolute",width:v,children:[!!x&&(0,s.jsx)(a.xv,{align:"center",color:"default",inline:!0,size:"100",weight:"bold",children:x}),e&&(0,s.jsx)(a.JO,{accessibilityLabel:k.bt("Tag anchor", "Tag anchor", "accessibility label for an anchor for an object in a pin", undefined, true),color:"error",icon:e,inline:!0,size:v/2})]})})})})},187963:(e,t,i)=>{i.d(t,{Z:()=>g});var n,a=i(667294);i(167912);var r=i(219308),s=i(984804),l=i(755090),o=i(785893);function u({showAnimation:e,auxData:t,index:i,isStela:n,onClick:a,onHover:u,onUnhover:c,spotlightCenter:d,viewParameter:h,viewType:p}){let m=(0,r.Z)(),x=n?1221:1260;(0,l.Z)(()=>{m({event_type:120,element:x,aux_data:t,view_parameter:h,view_type:p})});let g=parseFloat((.1*(i+1)).toFixed(2)),y={animation:e?`spotlightDotPop 0.6s ease-out ${g}s both`:"none"};return(0,o.jsx)(s.Z,{onClick:()=>{m({aux_data:t,element:x,event_type:101,view_parameter:h,view_type:p}),a(i)},onMouseEnter:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),u?.(i)},onMouseLeave:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),c?.()},style:y,x:d.x,y:d.y})}var c=i(962119),d=i(970601),h=i(372312),p=i(850610);let m=`
@keyframes spotlightDotPop {
  0% {
    transform: scale(0);
  }

  100% {
    transform: scale(1);
  }
}`,x=void 0!==n?n:n=i(482086),g=({showAnimation:e,pinKey:t,imageSignature:i,imageSize:n,currentSpotlightIdx:r,handleSpotlightClick:s,handleSpotlightHover:l,handleSpotlightUnhover:g,viewParameter:y,viewType:f,visualObjects:S})=>{let v=(0,c.Z)(x,t),w=(0,h.Z)(v),b=v?(v.visualObjects??[]).filter(e=>e.isStela):S??[];return(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(d.Z,{unsafeCSS:m}),b.map((t,a)=>{if(a===r)return null;let{x:c,y:d,w:h,h:m}=t,x=(0,p.Z)({cropArea:{x:c,y:d,w:h,h:m},scaledWidth:n.width??0,scaledHeight:n.height??0}),S={x:x.x+x.w/2,y:x.y+x.h/2},b={...w({override:{entrypoint:"flashlight"}}),pin_id:v?.entityId??"",image_signature:i,visual_objects:JSON.stringify([{x:t.x,y:t.y,w:t.w,h:t.h}])},_=`${S.x}${S.y}`;return(0,o.jsx)(u,{auxData:b,index:a,isStela:!!t?.isStela,onClick:s,onHover:l,onUnhover:g,showAnimation:e,spotlightCenter:S,viewParameter:y,viewType:f},_)})]})}},779561:(e,t,i)=>{i.d(t,{Z:()=>l});var n,a=i(667294);i(167912);var r=i(962119);let s=void 0!==n?n:n=i(752824);function l({pinKey:e,maxWidth:t}){let i=(0,r.Z)(s,e),n=i?.imageSpec_564x||i?.imageSpec_736x||i?.imageSpec_orig||i?.imageSpec_474x||i?.imageSpec_236x,l=n?.width||1,o=n?.height||1,u=n?.url||"",c=function(e,t,i=564){return e>i&&(t*=i/e,e=i),{width:e,height:t}}(l,o,t);return{getNormalizedPinImage:(0,a.useCallback)(()=>({width:c.width,height:c.height,url:u}),[c.height,c.width,u])}}},859075:(e,t,i)=>{i.d(t,{Z:()=>n});function n({cropArea:{x:e,y:t,w:i,h:n},scaledWidth:a,scaledHeight:r}){return{x:e/a,y:t/r,w:i/a,h:n/r}}},850610:(e,t,i)=>{i.d(t,{Z:()=>n});function n({cropArea:e,scaledWidth:t,scaledHeight:i}){let n=e.h||0,a=e.w||0;return{h:Math.floor(n*i),w:Math.floor(a*t),x:Math.floor((e.x||0)*t),y:Math.floor((e.y||0)*i)}}},288736:(e,t,i)=>{i.d(t,{I:()=>b,Z:()=>k});var n,a=i(667294);i(167912);var r=i(616550),s=i(883119),l=i(19963),o=i(476943),u=i(962119),c=i(779561),d=i(615071),h=i(970601),p=i(857147),m=i(785893);let x="cutout-overlay",g=`
  .${x}-enter {
    opacity: 0;
  }
  .${x}-enter-active {
    opacity: 1;
    transition: opacity 300ms;
  }
  .${x}-enter-done {
    opacity: 1;
  }
  .${x}-exit {
    opacity: 1;
  }
  .${x}-exit-active {
    opacity: 0;
    transition: opacity 300ms;
  }
  .${x}-exit-done {
    opacity: 0;
  }
`,y=e=>`url(#${e})`,f=e=>`#${e}`;function S({imageHeight:e,imageUrl:t,imageWidth:i,maskHeight:n,maskUrl:l,maskWidth:o,maskX:u,maskY:c,show:S}){let v=(0,a.useRef)(null),w=(0,r.TH)(),b=`${u}-${c}-${o}-${n}`,_=`blurFilter-${b}`,k=`maskImage-${b}`,M=`whiteImage-${b}`,z=`blurImage-${b}`,j=`cutoutMask-${b}`,P=`outlineMask-${b}`,{w:$,h:I}=(0,p.mB)(w.search),F=Number($)===i&&Number(I)===e||void 0===$&&void 0===I,E=.1*Math.min(100,Math.round(Math.min(o,n)));return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(h.Z,{unsafeCSS:g}),(0,m.jsx)(d.Z,{classNames:x,in:S,nodeRef:v,timeout:300,children:(0,m.jsx)(s.xu,{ref:v,dangerouslySetInlineStyle:{__style:{pointerEvents:"none",filter:`brightness(${F?1.2:1}`}},opacity:0,children:(0,m.jsxs)("svg",{"data-gestalt-valid-html":"Image",id:x,style:{position:"absolute",top:0,left:0,width:i,height:e},children:[(0,m.jsxs)("defs",{children:[(0,m.jsxs)("filter",{id:_,children:[(0,m.jsx)("feGaussianBlur",{edgeMode:"none",stdDeviation:E}),(0,m.jsx)("feComponentTransfer",{children:(0,m.jsx)("feFuncA",{amplitude:"1",exponent:2,offset:"0",type:"gamma"})})]}),(0,m.jsx)("mask",{id:j,children:(0,m.jsx)("image",{height:n,href:l,id:k,width:o,x:u,y:c})}),(0,m.jsx)("use",{href:f(k),id:M,mask:y(j)}),(0,m.jsx)("mask",{id:P,children:(0,m.jsx)("use",{filter:y(_),href:f(M),id:z})})]}),(0,m.jsx)("image",{height:e,href:t,mask:y(P),width:i,x:0,y:0})]})})})]})}let v=(e,t,i)=>{let n=0;for(let a=0;a<e.length-1;a+=1){let r=e[a],s=e[a+1];if(r&&s){let e=(s.x-r.x)*t,a=(s.y-r.y)*i;n+=Math.sqrt(e*e+a*a)}}if(e.length>0){let a=e[0],r=e[e.length-1];if(a&&r){let e=(a.x-r.x)*t,s=(a.y-r.y)*i;n+=Math.sqrt(e*e+s*s)}}return n};function w({contour:e,context:t,contourXRatio:i,contourYRatio:n}){t.beginPath(),e.points.forEach((e,a)=>{if(e){let r=e.x*i,s=e.y*n;0===a?t.moveTo(r,s):t.lineTo(r,s)}})}let b="stela-cutout",_=void 0!==n?n:n=i(314494);function k({auxData:e,bitmapData:t,hasAnimatedCutoutsOnLand:i,hasLoggedRender:n,hoveredCutoutIndex:d,index:h,pinImageHovered:p,pinKey:x,selectedCutoutIndex:g,setHasAnimatedCutoutsOnLand:y,setHasLoggedRender:f,viewParameter:k,viewType:M}){let{logContextEvent:z}=(0,l.v)(),j=(0,r.TH)(),P=(0,u.Z)(_,x),{getNormalizedPinImage:$}=(0,c.Z)({pinKey:P,maxWidth:o.Wm}),I=(0,a.useRef)(null),F=(0,a.useRef)(null),E=(0,a.useRef)(null),[L,D]=(0,a.useState)(0),[Z,T]=(0,a.useState)(!1),[A,C]=(0,a.useState)(0),[K,R]=(0,a.useState)(!1),W=j.pathname.includes("visual-search"),{height:q,width:H,url:N}=$(),{contours:O,contourXRatio:X,contourYRatio:B,isHidden:G,maskHeightRatio:U,maskUrl:Y,maskWidthRatio:J,maskXRatio:V,maskYRatio:Q}=t,ee=V*H,et=Q*q,ei=J*H,en=U*q,ea=d===h,er=g===h,es=O&&O.length>0;(0,a.useEffect)(()=>{n||(z({event_type:120,element:14154,view_parameter:k,view_type:M,aux_data:e}),f?.(!0))},[e,n,z,f,k,M]),(0,a.useEffect)(()=>{I.current&&(I.current.width=ei,I.current.height=en,F.current=new(window.OffscreenCanvas||window.HTMLCanvasElement)(ei,en))},[ei,en]);let el=(0,a.useCallback)(()=>{R(!0)},[]);return(0,a.useEffect)(()=>{let e=I.current;return e?.addEventListener("transitionend",el),()=>{e?.removeEventListener("transitionend",el)}}),(0,a.useEffect)(()=>{if(!I.current||!F.current||!es||!X||!B)return;let e=I.current.getContext("2d");if(i){e?.clearRect(0,0,I.current.width,I.current.height);return}return(!K||p||G&&ea)&&(E.current=requestAnimationFrame(()=>{if(!I.current||!F.current)return;let t=F.current.getContext("2d");e&&t&&(!function({contours:e,context:t,hasAnimatedCutoutsOnLand:i,hoveredCutoutIndex:n,index:a,isHidden:r,contourXRatio:s,contourYRatio:l,setTraceProgress:o,setHasAnimatedCutoutsOnLand:u,style:c,traceProgress:d,selectedCutoutIndex:h}){if(t.clearRect(0,0,t.canvas.width,t.canvas.height),!e||0===e.length||h===n&&n===a||h===a)return;let p={trace:{strokeStyle:"#fff",lineWidth:2},outline:{strokeStyle:"#fff",lineWidth:3}},m=r&&n===a,x=!r||m;if("trace"===c&&void 0!==d){let r=d,h=e[0].points.length;if(i){if(m||n===a){o(r=(r+900/v(e[0].points,s,l)*3.2/1e3)%1);let i=Math.floor(.33*h),n=Math.floor(h*r),a=(n-i+h)%h;e.map(e=>({...e,points:a<n?e.points.slice(a,n):e.points.slice(a).concat(e.points.slice(0,n))})).forEach(e=>{e.points.length>1&&(t.strokeStyle=p[c].strokeStyle,w({contour:e,context:t,contourXRatio:s,contourYRatio:l}),x&&(t.lineWidth=p[c].lineWidth,t.stroke()))})}}else{let i,n;if(o(r+=r<=1?.0032:.009600000000000001),r>=2){o(1),u(!0);return}let a=Math.floor(.33*h);r<=1?n=((i=Math.floor(h*r))-a+h)%h:(i=h,n=Math.floor(h-a+a*(r-1))),e.map(e=>{let t=[];return t=n<i?e.points.slice(n,i):e.points.slice(n).concat(e.points.slice(0,i)),{...e,points:t}}).forEach(e=>{e.points.length>1&&(t.strokeStyle=p[c].strokeStyle,w({contour:e,context:t,contourXRatio:s,contourYRatio:l}),x&&(t.lineWidth=p[c].lineWidth,t.stroke()))})}}else e.forEach(e=>{w({contour:e,context:t,contourXRatio:s,contourYRatio:l}),x&&(t.strokeStyle=p[c].strokeStyle,t.lineWidth=p[c].lineWidth,t.stroke(),n===a&&(t.save(),t.fillStyle="rgba(255, 255, 255, 0.25)",t.fill(),t.restore()))})}({contours:O,context:t,contourXRatio:X,contourYRatio:B,index:h,isHidden:G,hoveredCutoutIndex:d,opacity:L,setTraceProgress:C,hasAnimatedCutoutsOnLand:i,setHasAnimatedCutoutsOnLand:y,style:"trace",traceProgress:A,selectedCutoutIndex:g}),e.clearRect(0,0,I.current.width,I.current.height),e.drawImage(F.current,0,0))})),()=>{E.current&&(cancelAnimationFrame(E.current),E.current=null)}},[X,B,O,i,es,d,h,K,G,ea,L,p,g,y,A]),(0,a.useEffect)(()=>{if(p)T(!0),D(1);else if(Z)D(0);else{D(1);let e=setTimeout(()=>{T(!1),D(0)},3e3);return()=>clearTimeout(e)}},[p,Z,D]),(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(S,{imageHeight:q,imageUrl:N,imageWidth:H,maskHeight:en,maskUrl:Y,maskWidth:ei,maskX:ee,maskY:et,show:ea&&!er}),es&&(0,m.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{top:et,left:ee}},height:en,position:"absolute",width:ei,children:(0,m.jsx)("canvas",{ref:I,"data-test-id":"cutout-item",id:b,style:{opacity:W||p?1:L,transition:p||Z||W?"none":"opacity 2s linear 1s"}})})]})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/34075.en_IN-08f2f424bc36f564.mjs.map